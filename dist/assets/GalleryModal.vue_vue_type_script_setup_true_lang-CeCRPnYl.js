import{c as h,B,D as z,d as F,j as E,a,b as t,s as c,l as f,u as n,m as x,e as b,G as k,E as g,o as r,t as d,X as T,n as G,r as M,p as j,w as S,f as R,A as V}from"./index-DIaYYENC.js";/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=h("CheckIcon",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=h("CopyIcon",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=h("DownloadIcon",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=h("HeartIcon",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=h("PlayIcon",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),A="xztimes_favorites",N="xztimes_folders",O=localStorage.getItem(A),D=localStorage.getItem(N),v=B({favorites:O?JSON.parse(O):[],folders:D?JSON.parse(D):[],addFavorite(e){this.isFavorite(e.id)||this.favorites.unshift({...e,createdAt:Date.now()})},removeFavorite(e){const i=this.favorites.findIndex(s=>s.id===e);i>-1&&this.favorites.splice(i,1)},isFavorite(e){return this.favorites.some(i=>i.id===e)},toggleFavorite(e){this.isFavorite(e.id)?this.removeFavorite(e.id):this.addFavorite(e)},createFolder(e){const i=`folder_${Date.now()}`;return this.folders.push({id:i,name:e,createdAt:Date.now()}),i},deleteFolder(e){const i=this.folders.findIndex(s=>s.id===e);i>-1&&(this.folders.splice(i,1),this.favorites.forEach(s=>{s.folderId===e&&(s.folderId=void 0)}))},moveToFolder(e,i){const s=this.favorites.find(m=>m.id===e);s&&(s.folderId=i)}});z(()=>v.favorites,e=>{localStorage.setItem(A,JSON.stringify(e))},{deep:!0});z(()=>v.folders,e=>{localStorage.setItem(N,JSON.stringify(e))},{deep:!0});const J=["src","alt"],q={key:0,class:"absolute top-2 right-2 bg-black/50 backdrop-blur-sm p-1.5 rounded-full z-10"},K={class:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-4"},L={class:"flex items-center justify-between transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300"},Y={class:"flex gap-2"},X={key:0,class:"p-2 rounded-full bg-white/20 backdrop-blur-md text-white hover:bg-primary hover:text-white transition-colors",title:"播放"},Z={key:0,class:"p-3 bg-bg-card border-t border-border-base"},Q={key:0,class:"text-sm font-medium text-text-primary truncate mb-1"},U={key:1,class:"text-xs text-text-secondary truncate"},ze=F({__name:"GalleryCard",props:{item:{},aspectRatio:{}},emits:["click","download"],setup(e,{emit:i}){const s=e,m=i,u=E(()=>v.isFavorite(s.item.id)),y=l=>{l.stopPropagation(),v.toggleFavorite(s.item),u.value?g.success("收藏成功"):g.info("已取消收藏")},p=l=>{l.stopPropagation(),m("download",s.item);const o=document.createElement("a");o.href=s.item.src,o.download=`download-${s.item.id}`,document.body.appendChild(o),o.click(),document.body.removeChild(o)};return(l,o)=>(r(),a("div",{class:"group relative rounded-base overflow-hidden bg-bg-card border border-border-base shadow-sm hover:shadow-glow transition-all duration-300 cursor-pointer",onClick:o[0]||(o[0]=w=>l.$emit("click",e.item))},[t("div",{class:f(n(x)("w-full relative overflow-hidden",e.aspectRatio||"aspect-square"))},[t("img",{src:e.item.src,alt:e.item.title||"Gallery Item",class:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110",loading:"lazy"},null,8,J),e.item.type==="video"?(r(),a("div",q,[b(n(C),{class:"w-4 h-4 text-white fill-white"})])):c("",!0),t("div",K,[t("div",L,[t("div",Y,[t("button",{onClick:y,class:f(n(x)("p-2 rounded-full backdrop-blur-md transition-colors",u.value?"bg-primary text-white":"bg-white/20 text-white hover:bg-primary")),title:"收藏"},[b(n($),{class:f(n(x)("w-4 h-4",u.value&&"fill-current"))},null,8,["class"])],2),e.item.type==="video"?(r(),a("button",X,[b(n(C),{class:"w-4 h-4 fill-current"})])):c("",!0)]),t("button",{onClick:p,class:"p-2 rounded-full bg-white/20 backdrop-blur-md text-white hover:bg-primary hover:text-white transition-colors",title:"下载"},[b(n(H),{class:"w-4 h-4"})])])])],2),l.$slots.info||e.item.title||e.item.prompt?(r(),a("div",Z,[k(l.$slots,"info",{},()=>[e.item.title?(r(),a("h4",Q,d(e.item.title),1)):c("",!0),e.item.prompt?(r(),a("p",U,d(e.item.prompt),1)):c("",!0)])])):c("",!0)]))}}),W={key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6"},ee={class:"flex items-center justify-between p-6 border-b border-border-base sticky top-0 bg-bg-base z-10"},te={class:"text-lg font-bold text-text-primary"},se={class:"p-6 flex-1"},oe={key:0,class:"p-6 border-t border-border-base bg-bg-page flex justify-end gap-3 sticky bottom-0 z-10"},ie=F({__name:"Dialog",props:{isOpen:{type:Boolean},title:{},width:{}},emits:["close"],setup(e){return(i,s)=>e.isOpen?(r(),a("div",W,[t("div",{class:"absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:s[0]||(s[0]=m=>i.$emit("close"))}),t("div",{class:f(n(x)("relative bg-bg-base rounded-lg shadow-xl w-full max-h-[90vh] overflow-y-auto flex flex-col animate-in fade-in zoom-in-95 duration-200",e.width?"":"max-w-2xl")),style:G({width:e.width})},[t("div",ee,[t("h3",te,d(e.title),1),t("button",{onClick:s[1]||(s[1]=m=>i.$emit("close")),class:"text-text-secondary hover:text-text-primary transition-colors"},[b(n(T),{class:"w-5 h-5"})])]),t("div",se,[k(i.$slots,"default")]),i.$slots.footer?(r(),a("div",oe,[k(i.$slots,"footer")])):c("",!0)],6)])):c("",!0)}}),re={key:0,class:"flex flex-col md:flex-row gap-6"},ae={class:"w-full md:w-1/2 space-y-4"},le={class:"aspect-[2/3] rounded-base overflow-hidden bg-bg-page border border-border-base relative group"},ne=["src","alt"],de={key:0,class:"absolute inset-0 flex items-center justify-center bg-black/30"},ce={class:"absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity"},me={class:"w-full md:w-1/2 space-y-6"},ue={key:0,class:"flex items-center gap-3 pb-4 border-b border-border-base"},be={class:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center overflow-hidden"},fe=["src"],ve={key:1,class:"text-primary font-bold"},he={class:"font-bold text-text-primary"},ye={class:"text-sm text-text-secondary"},xe={key:1},ge={class:"px-3 py-2 bg-bg-page rounded-base text-primary border border-primary/30 inline-block"},pe={class:"flex items-center justify-between mb-2"},we={class:"p-3 bg-bg-page rounded-base text-text-primary border border-border-base text-sm leading-relaxed h-32 overflow-y-auto scrollbar-thin scrollbar-thumb-border-base"},ke={key:2,class:"grid grid-cols-2 gap-4"},$e={class:"p-3 bg-bg-page rounded-base border border-border-base text-center"},Ce={class:"text-text-primary font-bold"},Fe={class:"p-3 bg-bg-page rounded-base border border-border-base text-center"},Ie={class:"text-text-primary font-bold"},je={class:"flex items-center justify-between w-full"},Se={class:"text-sm"},Oe={class:"flex gap-3 ml-auto"},Ee=F({__name:"GalleryModal",props:{isOpen:{type:Boolean},item:{}},emits:["close","use","edit"],setup(e,{emit:i}){const s=e,m=E(()=>s.item&&v.isFavorite(s.item.id)),u=M(!1),y=()=>{s.item&&(v.toggleFavorite(s.item),m.value?g.success("收藏成功"):g.info("已取消收藏"))},p=()=>{var l;(l=s.item)!=null&&l.prompt&&(navigator.clipboard.writeText(s.item.prompt),u.value=!0,setTimeout(()=>u.value=!1,2e3))};return(l,o)=>{var w;return r(),j(ie,{isOpen:e.isOpen,onClose:o[2]||(o[2]=I=>l.$emit("close")),title:((w=e.item)==null?void 0:w.title)||"作品详情",width:"60%"},{footer:S(()=>[t("div",je,[t("button",{onClick:y,class:"flex items-center gap-2 text-text-secondary hover:text-primary transition-colors md:hidden"},[b(n($),{class:f(["w-5 h-5",{"fill-current text-primary":m.value}])},null,8,["class"]),t("span",Se,d(m.value?"已收藏":"收藏"),1)]),t("div",Oe,[t("button",{onClick:o[0]||(o[0]=I=>l.$emit("edit",e.item)),class:"el-button el-button-default px-4 py-2 rounded-base"}," 编辑内容 "),t("button",{onClick:o[1]||(o[1]=I=>l.$emit("use",e.item)),class:"el-button el-button-primary px-4 py-2 rounded-base"}," 使用此模板 ")])])]),default:S(()=>[e.item?(r(),a("div",re,[t("div",ae,[t("div",le,[t("img",{src:e.item.src,alt:e.item.title,class:"w-full h-full object-cover"},null,8,ne),e.item.type==="video"?(r(),a("div",de,[b(n(C),{class:"w-12 h-12 text-white fill-white/50"})])):c("",!0),t("div",ce,[t("button",{onClick:y,class:f(["p-2 rounded-full bg-black/50 backdrop-blur-md text-white hover:bg-primary transition-colors",{"bg-primary text-white":m.value}])},[b(n($),{class:f(["w-5 h-5",{"fill-current":m.value}])},null,8,["class"])],2)])])]),t("div",me,[e.item.user?(r(),a("div",ue,[t("div",be,[e.item.user.avatar?(r(),a("img",{key:0,src:e.item.user.avatar,class:"w-full h-full object-cover"},null,8,fe)):(r(),a("span",ve,d(e.item.user.name[0]),1))]),t("div",null,[t("h3",he,d(e.item.title||"未命名作品"),1),t("p",ye,"by "+d(e.item.user.name),1)])])):c("",!0),e.item.style?(r(),a("div",xe,[o[3]||(o[3]=t("label",{class:"text-sm font-medium text-text-secondary block mb-2"},"风格",-1)),t("div",ge,d(e.item.style),1)])):c("",!0),t("div",null,[t("div",pe,[o[4]||(o[4]=t("label",{class:"text-sm font-medium text-text-secondary"},"提示词",-1)),t("button",{onClick:p,class:"text-xs flex items-center gap-1 text-primary hover:text-primary-hover transition-colors"},[(r(),j(V(u.value?n(_):n(P)),{class:"w-3 h-3"})),R(" "+d(u.value?"已复制":"复制"),1)])]),t("div",we,d(e.item.prompt),1)]),e.item.likes!==void 0?(r(),a("div",ke,[t("div",$e,[o[5]||(o[5]=t("div",{class:"text-text-secondary text-xs mb-1"},"喜欢",-1)),t("div",Ce,d(e.item.likes),1)]),t("div",Fe,[o[6]||(o[6]=t("div",{class:"text-text-secondary text-xs mb-1"},"使用",-1)),t("div",Ie,d(e.item.runs),1)])])):c("",!0)])])):c("",!0)]),_:1},8,["isOpen","title"])}}});export{H as D,$ as H,Ee as _,ze as a,v as s};
